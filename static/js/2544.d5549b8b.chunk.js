"use strict";(self.webpackChunksc_depot=self.webpackChunksc_depot||[]).push([[2544],{62544:(e,a,r)=>{r.r(a),r.d(a,{fromUrl:()=>c});var t=r(50076),n=r(90534),l=r(13096),i=r(39323),s=r(11668),o=r(31933),u=r(62487),y=r(67061);const d={FeatureLayer:!0,SceneLayer:!0};async function c(e){const{properties:a,url:t}=e,n={...a,url:t},l=await w(t,null===a||void 0===a?void 0:a.customParameters),{Constructor:i,layerId:s,sourceJSON:o,parsedUrl:u,layers:y,tables:d}=l;if(y.length+d.length===0)return null!=s&&(n.layerId=s),null!=o&&(n.sourceJSON=o),new i(n);const c=new(0,(await r.e(6095).then(r.bind(r,16095))).default)({title:u.title});return await async function(e,a,r){const t=a.sublayerConstructorProvider;for(const{id:l,serverUrl:i}of a.layers){var n;const s=f(a.sublayerInfos,l),o=v(i,l,s,null!==(n=s&&(null===t||void 0===t?void 0:t(s)))&&void 0!==n?n:a.Constructor,r);e.add(o)}if(a.tables.length){const t=await b("FeatureLayer");a.tables.forEach((n=>{let{id:l,serverUrl:i}=n;const s=v(i,l,f(a.tableInfos,l),t,r);e.tables.add(s)}))}}(c,l,n),c}function f(e,a){return e?e.find((e=>{let{id:r}=e;return r===a})):null}function v(e,a,r,t,n){const l={...n,layerId:a};return null!=e&&(l.url=e),null!=r&&(l.sourceJSON=r),"sublayerTitleMode"in t.prototype&&(l.sublayerTitleMode="service-name"),new t(l)}async function w(e,a){let r=(0,l.qg)(e);if(null==r&&(r=await async function(e,a){var r,t;const i=await(0,y.V)(e,{customParameters:a});let s=null,o=null;const u=i.type;if("Feature Layer"===u||"Table"===u?(s="FeatureServer",o=null!==(r=i.id)&&void 0!==r?r:null):"indexedVector"===u?s="VectorTileServer":i.hasOwnProperty("mapName")?s="MapServer":i.hasOwnProperty("bandCount")&&i.hasOwnProperty("pixelSizeX")?s="ImageServer":i.hasOwnProperty("maxRecordCount")&&i.hasOwnProperty("allowGeometryUpdates")?s="FeatureServer":i.hasOwnProperty("streamUrls")?s="StreamServer":h(i)?(s="SceneServer",o=i.id):i.hasOwnProperty("layers")&&h(null===(t=i.layers)||void 0===t?void 0:t[0])&&(s="SceneServer"),!s)return null;const d=null!=o?(0,l.iz)(e):null;return{title:null!=d&&i.name||(0,n.e7)(e),serverType:s,sublayer:o,url:{path:null!=d?d.serviceUrl:(0,n.An)(e).path}}}(e,a)),null==r)throw new t.A("arcgis-layers:url-mismatch","The url '${url}' is not a valid arcgis resource",{url:e});const{serverType:u,sublayer:c}=r;let f;const v={FeatureServer:"FeatureLayer",KnowledgeGraphServer:"KnowledgeGraphLayer",StreamServer:"StreamLayer",VectorTileServer:"VectorTileLayer",VideoServer:"VideoLayer"},w="FeatureServer"===u,p="SceneServer"===u,L={parsedUrl:r,Constructor:null,layerId:(w||p)&&null!==c&&void 0!==c?c:void 0,layers:[],tables:[]};switch(u){case"MapServer":if(null!=c){const{type:r}=await(0,y.V)(e,{customParameters:a});switch(f="FeatureLayer",r){case"Catalog Layer":f="CatalogLayer";break;case"Catalog Dynamic Group Layer":throw new t.A("arcgis-layers:unsupported",'fromUrl() not supported for "'.concat(r,'" layers'))}}else f=await async function(e,a){return(await(0,y.V)(e,{customParameters:a})).tileInfo}(e,a)?"TileLayer":"MapImageLayer";break;case"ImageServer":{var m;const r=await(0,y.V)(e,{customParameters:a}),{tileInfo:t,cacheType:n}=r;f=t?"LERC"!==(null===t||void 0===t||null===(m=t.format)||void 0===m?void 0:m.toUpperCase())||n&&"elevation"!==n.toLowerCase()?"ImageryTileLayer":"ElevationLayer":"ImageryLayer";break}case"SceneServer":{const e=await(0,y.V)(r.url.path,{customParameters:a});if(f="SceneLayer",e){const a=null===e||void 0===e?void 0:e.layers;if("Voxel"===(null===e||void 0===e?void 0:e.layerType))f="VoxelLayer";else if(null!==a&&void 0!==a&&a.length){var S;const e=null===(S=a[0])||void 0===S?void 0:S.layerType;null!=e&&null!=o.XX[e]&&(f=o.XX[e])}}break}case"3DTilesServer":throw new t.A("arcgis-layers:unsupported","fromUrl() not supported for 3DTiles layers");case"FeatureServer":if(f="FeatureLayer",null!=c){const r=await(0,y.V)(e,{customParameters:a});L.sourceJSON=r,f=(0,s.K)(r.type)}break;default:f=v[u]}if(d[f]&&null==c){var g;const r=await async function(e,a,r){var t,n;let l,o,u=!1;switch(a){case"FeatureServer":{const a=await(0,s.Q)(e,{customParameters:r});u=!!a.layersJSON,l=a.layersJSON||a.serviceJSON;break}case"SceneServer":{const a=await async function(e,a){var r;const t=await(0,y.V)(e,{customParameters:a}),n=null===(r=t.layers)||void 0===r?void 0:r[0];if(!n)return{serviceInfo:t};try{const{serverUrl:r}=await(0,i.L)(e),n=await(0,y.V)(r,{customParameters:a}).catch((()=>null));return n&&(t.tables=n.tables),{serviceInfo:t,tableServerUrl:r}}catch{return{serviceInfo:t}}}(e,r);l=a.serviceInfo,o=a.tableServerUrl;break}default:l=await(0,y.V)(e,{customParameters:r})}const d=null===(t=l)||void 0===t?void 0:t.layers,c=null===(n=l)||void 0===n?void 0:n.tables;return{layers:(null===d||void 0===d?void 0:d.map((e=>({id:e.id}))).reverse())||[],tables:(null===c||void 0===c?void 0:c.map((e=>({serverUrl:o,id:e.id}))).reverse())||[],layerInfos:u?d:[],tableInfos:u?c:[]}}(e,u,a);if(w&&(L.sublayerInfos=r.layerInfos,L.tableInfos=r.tableInfos),1!==r.layers.length+r.tables.length)L.layers=r.layers,L.tables=r.tables,w&&(null===(g=r.layerInfos)||void 0===g?void 0:g.length)&&(L.sublayerConstructorProvider=await async function(e){if(!e.length)return;const a=new Set,r=[];for(const{type:l}of e)a.has(l)||(a.add(l),r.push(b((0,s.K)(l))));const t=await Promise.all(r),n=new Map;return Array.from(a).forEach(((e,a)=>{n.set(e,t[a])})),e=>n.get(e.type)}(r.layerInfos));else if(w||p){var P,I,O,T,C,V;const e=null!==(P=null===(I=r.layerInfos)||void 0===I?void 0:I[0])&&void 0!==P?P:null===(O=r.tableInfos)||void 0===O?void 0:O[0];if(L.layerId=null!==(T=null===(C=r.layers[0])||void 0===C?void 0:C.id)&&void 0!==T?T:null===(V=r.tables[0])||void 0===V?void 0:V.id,L.sourceJSON=e,w){const a=null===e||void 0===e?void 0:e.type;f=(0,s.K)(a)}}}return L.Constructor=await b(f),L}function h(e){return null!=e&&e.hasOwnProperty("store")&&e.hasOwnProperty("id")&&"number"==typeof e.id}async function b(e){return(0,u.S[e])()}},11668:(e,a,r)=>{r.d(a,{K:()=>c,Q:()=>l});var t=r(67061);const n=new Set(["Catalog Layer","Feature Layer","Oriented Imagery Layer"]);async function l(e,a){var r;const{loadContext:n,...l}=a||{},i=n?await n.fetchServiceMetadata(e,l):await(0,t.V)(e,l);d(i),o(i);const s={serviceJSON:i};if((null!==(r=i.currentVersion)&&void 0!==r?r:0)<10.5)return s;const u="".concat(e,"/layers"),y=n?await n.fetchServiceMetadata(u,l):await(0,t.V)(u,l);return d(y),o(y),s.layersJSON={layers:y.layers,tables:y.tables},s}function i(e){const{type:a}=e;return!!a&&n.has(a)}function s(e){return"Table"===e.type}function o(e){var a,r;e.layers=null===(a=e.layers)||void 0===a?void 0:a.filter(i),e.tables=null===(r=e.tables)||void 0===r?void 0:r.filter(s)}function u(e){e.type||(e.type="Feature Layer")}function y(e){e.type||(e.type="Table")}function d(e){var a,r;null!==(a=e.layers)&&void 0!==a&&a.forEach(u),null===(r=e.tables)||void 0===r||r.forEach(y)}function c(e){switch(e){case"Feature Layer":case"Table":return"FeatureLayer";case"Oriented Imagery Layer":return"OrientedImageryLayer";case"Catalog Layer":return"CatalogLayer"}return"FeatureLayer"}},62487:(e,a,r)=>{r.d(a,{S:()=>t});const t={BingMapsLayer:async()=>(await r.e(3993).then(r.bind(r,13993))).default,BuildingSceneLayer:async()=>(await Promise.resolve().then(r.bind(r,82740))).default,CSVLayer:async()=>(await r.e(1365).then(r.bind(r,1365))).default,CatalogLayer:async()=>(await Promise.all([r.e(9122),r.e(2003),r.e(982),r.e(9078),r.e(4397)]).then(r.bind(r,84397))).default,DimensionLayer:async()=>(await r.e(126).then(r.bind(r,70126))).default,ElevationLayer:async()=>(await r.e(3875).then(r.bind(r,23875))).default,FeatureLayer:async()=>(await Promise.resolve().then(r.bind(r,38451))).default,GeoJSONLayer:async()=>(await r.e(709).then(r.bind(r,50709))).default,GeoRSSLayer:async()=>(await r.e(2551).then(r.bind(r,52551))).default,GroupLayer:async()=>(await r.e(6095).then(r.bind(r,16095))).default,ImageryLayer:async()=>(await Promise.all([r.e(9122),r.e(6333),r.e(7480),r.e(9051)]).then(r.bind(r,59051))).default,ImageryTileLayer:async()=>(await Promise.all([r.e(6333),r.e(9844),r.e(9571),r.e(7480),r.e(7416)]).then(r.bind(r,47416))).default,IntegratedMesh3DTilesLayer:async()=>(await r.e(6790).then(r.bind(r,76790))).default,IntegratedMeshLayer:async()=>(await r.e(2825).then(r.bind(r,32825))).default,KMLLayer:async()=>(await r.e(2712).then(r.bind(r,72712))).default,KnowledgeGraphLayer:async()=>(await Promise.all([r.e(7216),r.e(3620),r.e(2003),r.e(1047),r.e(4476),r.e(7118),r.e(6570)]).then(r.bind(r,26570))).default,LineOfSightLayer:async()=>(await r.e(2635).then(r.bind(r,62635))).default,LinkChartLayer:async()=>(await Promise.all([r.e(7216),r.e(3620),r.e(2003),r.e(1047),r.e(4476),r.e(7118),r.e(2218)]).then(r.bind(r,92218))).default,MapImageLayer:async()=>(await Promise.all([r.e(9122),r.e(982),r.e(5721),r.e(2951)]).then(r.bind(r,82951))).default,MapNotesLayer:async()=>(await r.e(3311).then(r.bind(r,43311))).default,MediaLayer:async()=>(await Promise.all([r.e(9639),r.e(5355)]).then(r.bind(r,46061))).default,OGCFeatureLayer:async()=>(await Promise.all([r.e(6799),r.e(5526)]).then(r.bind(r,1741))).default,OpenStreetMapLayer:async()=>(await r.e(803).then(r.bind(r,50803))).default,OrientedImageryLayer:async()=>(await r.e(2593).then(r.bind(r,52593))).default,PointCloudLayer:async()=>(await r.e(1830).then(r.bind(r,11830))).default,RouteLayer:async()=>(await Promise.all([r.e(1297),r.e(1301)]).then(r.bind(r,91301))).default,SceneLayer:async()=>(await Promise.all([r.e(3141),r.e(8320)]).then(r.bind(r,48320))).default,StreamLayer:async()=>(await r.e(4369).then(r.bind(r,84369))).default,SubtypeGroupLayer:async()=>(await r.e(9005).then(r.bind(r,69005))).default,TileLayer:async()=>(await Promise.all([r.e(9122),r.e(982),r.e(5721),r.e(1174)]).then(r.bind(r,71174))).default,UnknownLayer:async()=>(await r.e(8896).then(r.bind(r,8896))).default,UnsupportedLayer:async()=>(await r.e(2043).then(r.bind(r,72043))).default,VectorTileLayer:async()=>(await Promise.all([r.e(8376),r.e(3451)]).then(r.bind(r,53451))).default,VideoLayer:async()=>(await r.e(9398).then(r.bind(r,19398))).default,VoxelLayer:async()=>(await r.e(8560).then(r.bind(r,88560))).default,WFSLayer:async()=>(await Promise.all([r.e(1316),r.e(6964)]).then(r.bind(r,4583))).default,WMSLayer:async()=>(await r.e(2015).then(r.bind(r,52015))).default,WMTSLayer:async()=>(await r.e(1845).then(r.bind(r,1845))).default,WebTileLayer:async()=>(await r.e(4552).then(r.bind(r,24552))).default}},67061:(e,a,r)=>{r.d(a,{V:()=>n});var t=r(3825);async function n(e,a){const{data:r}=await(0,t.A)(e,{responseType:"json",query:{f:"json",...null===a||void 0===a?void 0:a.customParameters,token:null===a||void 0===a?void 0:a.apiKey}});return r}}}]);
//# sourceMappingURL=2544.d5549b8b.chunk.js.map