"use strict";(self.webpackChunksc_depot=self.webpackChunksc_depot||[]).push([[7371],{80069:(e,t,n)=>{n.d(t,{F:()=>a,a:()=>c,b:()=>u});var r=n(73398),i=n(72790),s=n(64839),o=n(32307),l=n(70367);class a extends s.Y{}function u(){const e=new o.N5;return e.include(r.c),e.outputs.add("fragColor","vec4",0),e.fragment.uniforms.add(new l.N("colorTexture",(e=>e.color)),new l.N("focusArea",(e=>e.focusArea)),new i.c("focusAreaEffectMode",(e=>e.effect??1))).main.add(s.H`float mask = texture( focusArea, uv, 0.0 ).r;
vec4 color = texture( colorTexture, uv, 0.0 );
vec4 colorDeSaturate = vec4(color.r * 0.25 + color.g * 0.5 + color.b * 0.25);
if (focusAreaEffectMode == 1) {
fragColor = mask > 0.0 ? color : 0.55 * colorDeSaturate + 0.45;
} else {
fragColor = mask > 0.0 ? color : 0.33 * mix(color, colorDeSaturate, 0.);
}`),e}const c=Object.freeze(Object.defineProperty({__proto__:null,FocusAreaColorPassParameters:a,build:u},Symbol.toStringTag,{value:"Module"}))},40366:(e,t,n)=>{n.d(t,{F:()=>c,a:()=>d,b:()=>h});var r=n(34761),i=n(13191),s=n(9392),o=n(64839),l=n(43425),a=n(32307),u=n(66470);class c extends o.Y{constructor(){super(...arguments),this.origin=s.uY}}function h(){const e=new a.N5;return e.attributes.add(u.r.POSITION,"vec3"),e.outputs.add("fragColor","vec4",0),e.vertex.uniforms.add(new l.X("proj",((e,t)=>t.camera.projectionMatrix)),new l.X("view",((e,t)=>(0,r.Tl)(f,t.camera.viewMatrix,e.origin)))).main.add(o.H`gl_Position = proj * view * vec4(position, 1.0);`),e.fragment.main.add(o.H`fragColor = vec4(1., 0., 0., 1.);`),e}const f=(0,i.vt)(),d=Object.freeze(Object.defineProperty({__proto__:null,FocusAreaMaskPassParameters:c,build:h},Symbol.toStringTag,{value:"Module"}))},38983:(e,t,n)=>{function r(e,t,n){n=n||2;var r,s,l,a,u,c,f,d=t&&t.length,p=d?t[0]*n:e.length,x=i(e,0,p,n,!0),v=[];if(!x||x.next===x.prev)return v;if(d&&(x=h(e,t,x,n)),e.length>80*n){r=l=e[0],s=a=e[1];for(var y=n;y<p;y+=n)(u=e[y])<r&&(r=u),(c=e[y+1])<s&&(s=c),u>l&&(l=u),c>a&&(a=c);f=0!==(f=Math.max(l-r,a-s))?1/f:0}return o(x,v,n,r,s,f),v}function i(e,t,n,r,i){var s,o;if(i===R(e,t,n,r)>0)for(s=t;s<n;s+=r)o=S(s,e[s],e[s+1],o);else for(s=n-r;s>=t;s-=r)o=S(s,e[s],e[s+1],o);if(o&&m(o,o.next)){var l=o.next;N(o),o=l}return o}function s(e,t){if(!e)return e;t||(t=e);var n,r=e;do{if(n=!1,r.steiner||!m(r,r.next)&&0!==A(r.prev,r,r.next))r=r.next;else{var i=r.prev;if(N(r),(r=t=i)===r.next)break;n=!0}}while(n||r!==t);return t}function o(e,t,n,r,i,h,f){if(e){!f&&h&&v(e,r,i,h);for(var d,p,x=e;e.prev!==e.next;)if(d=e.prev,p=e.next,h?a(e,r,i,h):l(e))t.push(d.i/n),t.push(e.i/n),t.push(p.i/n),N(e),e=p.next,x=p.next;else if((e=p)===x){f?1===f?o(e=u(s(e),t,n),t,n,r,i,h,2):2===f&&c(e,t,n,r,i,h):o(s(e),t,n,r,i,h,1);break}}}function l(e){var t=e.prev,n=e,r=e.next;if(A(t,n,r)>=0)return!1;for(var i=e.next.next;i!==e.prev;){if(_(t.x,t.y,n.x,n.y,r.x,r.y,i.x,i.y)&&A(i.prev,i,i.next)>=0)return!1;i=i.next}return!0}function a(e,t,n,r){var i=e.prev,s=e,o=e.next;if(A(i,s,o)>=0)return!1;for(var l=i.x<s.x?i.x<o.x?i.x:o.x:s.x<o.x?s.x:o.x,a=i.y<s.y?i.y<o.y?i.y:o.y:s.y<o.y?s.y:o.y,u=i.x>s.x?i.x>o.x?i.x:o.x:s.x>o.x?s.x:o.x,c=i.y>s.y?i.y>o.y?i.y:o.y:s.y>o.y?s.y:o.y,h=y(l,a,t,n,r),f=y(u,c,t,n,r),d=e.prevZ,p=e.nextZ;d&&d.z>=h&&p&&p.z<=f;){if(d!==e.prev&&d!==e.next&&_(i.x,i.y,s.x,s.y,o.x,o.y,d.x,d.y)&&A(d.prev,d,d.next)>=0)return!1;if(d=d.prevZ,p!==e.prev&&p!==e.next&&_(i.x,i.y,s.x,s.y,o.x,o.y,p.x,p.y)&&A(p.prev,p,p.next)>=0)return!1;p=p.nextZ}for(;d&&d.z>=h;){if(d!==e.prev&&d!==e.next&&_(i.x,i.y,s.x,s.y,o.x,o.y,d.x,d.y)&&A(d.prev,d,d.next)>=0)return!1;d=d.prevZ}for(;p&&p.z<=f;){if(p!==e.prev&&p!==e.next&&_(i.x,i.y,s.x,s.y,o.x,o.y,p.x,p.y)&&A(p.prev,p,p.next)>=0)return!1;p=p.nextZ}return!0}function u(e,t,n){var r=e;do{var i=r.prev,o=r.next.next;!m(i,o)&&b(i,r,r.next,o)&&C(i,o)&&C(o,i)&&(t.push(i.i/n),t.push(r.i/n),t.push(o.i/n),N(r),N(r.next),r=e=o),r=r.next}while(r!==e);return s(r)}function c(e,t,n,r,i,l){var a=e;do{for(var u=a.next.next;u!==a.prev;){if(a.i!==u.i&&w(a,u)){var c=Z(a,u);return a=s(a,a.next),c=s(c,c.next),o(a,t,n,r,i,l),void o(c,t,n,r,i,l)}u=u.next}a=a.next}while(a!==e)}function h(e,t,n,r){var o,l,a,u=[];for(o=0,l=t.length;o<l;o++)(a=i(e,t[o]*r,o<l-1?t[o+1]*r:e.length,r,!1))===a.next&&(a.steiner=!0),u.push(g(a));for(u.sort(f),o=0;o<u.length;o++)n=s(n=p(u[o],n),n.next);return n}function f(e,t){return e.x-t.x}function d(e){if(e.next.prev===e)return e;let t=e;for(;;){const n=t.next;if(n.prev===t||n===t||n===e)break;t=n}return t}function p(e,t){var n=function(e,t){var n,r=t,i=e.x,s=e.y,o=-1/0;do{if(s<=r.y&&s>=r.next.y&&r.next.y!==r.y){var l=r.x+(s-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(l<=i&&l>o){if(o=l,l===i){if(s===r.y)return r;if(s===r.next.y)return r.next}n=r.x<r.next.x?r:r.next}}r=r.next}while(r!==t);if(!n)return null;if(i===o)return n;var a,u=n,c=n.x,h=n.y,f=1/0;r=n;do{i>=r.x&&r.x>=c&&i!==r.x&&_(s<h?i:o,s,c,h,s<h?o:i,s,r.x,r.y)&&(a=Math.abs(s-r.y)/(i-r.x),C(r,e)&&(a<f||a===f&&(r.x>n.x||r.x===n.x&&x(n,r)))&&(n=r,f=a)),r=r.next}while(r!==u);return n}(e,t);if(!n)return t;var r=Z(n,e),i=s(n,n.next);let o=d(r);return s(o,o.next),i=d(i),d(t===n?i:t)}function x(e,t){return A(e.prev,e,t.prev)<0&&A(t.next,e,e.next)<0}function v(e,t,n,r){var i=e;do{null===i.z&&(i.z=y(i.x,i.y,t,n,r)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next}while(i!==e);i.prevZ.nextZ=null,i.prevZ=null,function(e){var t,n,r,i,s,o,l,a,u=1;do{for(n=e,e=null,s=null,o=0;n;){for(o++,r=n,l=0,t=0;t<u&&(l++,r=r.nextZ);t++);for(a=u;l>0||a>0&&r;)0!==l&&(0===a||!r||n.z<=r.z)?(i=n,n=n.nextZ,l--):(i=r,r=r.nextZ,a--),s?s.nextZ=i:e=i,i.prevZ=s,s=i;n=r}s.nextZ=null,u*=2}while(o>1)}(i)}function y(e,t,n,r,i){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-n)*i)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-r)*i)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function g(e){var t=e,n=e;do{(t.x<n.x||t.x===n.x&&t.y<n.y)&&(n=t),t=t.next}while(t!==e);return n}function _(e,t,n,r,i,s,o,l){return(i-o)*(t-l)-(e-o)*(s-l)>=0&&(e-o)*(r-l)-(n-o)*(t-l)>=0&&(n-o)*(s-l)-(i-o)*(r-l)>=0}function w(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!function(e,t){var n=e;do{if(n.i!==e.i&&n.next.i!==e.i&&n.i!==t.i&&n.next.i!==t.i&&b(n,n.next,e,t))return!0;n=n.next}while(n!==e);return!1}(e,t)&&(C(e,t)&&C(t,e)&&function(e,t){var n=e,r=!1,i=(e.x+t.x)/2,s=(e.y+t.y)/2;do{n.y>s!=n.next.y>s&&n.next.y!==n.y&&i<(n.next.x-n.x)*(s-n.y)/(n.next.y-n.y)+n.x&&(r=!r),n=n.next}while(n!==e);return r}(e,t)&&(A(e.prev,e,t.prev)||A(e,t.prev,t))||m(e,t)&&A(e.prev,e,e.next)>0&&A(t.prev,t,t.next)>0)}function A(e,t,n){return(t.y-e.y)*(n.x-t.x)-(t.x-e.x)*(n.y-t.y)}function m(e,t){return e.x===t.x&&e.y===t.y}function b(e,t,n,r){var i=M(A(e,t,n)),s=M(A(e,t,r)),o=M(A(n,r,e)),l=M(A(n,r,t));return i!==s&&o!==l||!(0!==i||!E(e,n,t))||!(0!==s||!E(e,r,t))||!(0!==o||!E(n,e,r))||!(0!==l||!E(n,t,r))}function E(e,t,n){return t.x<=Math.max(e.x,n.x)&&t.x>=Math.min(e.x,n.x)&&t.y<=Math.max(e.y,n.y)&&t.y>=Math.min(e.y,n.y)}function M(e){return e>0?1:e<0?-1:0}function C(e,t){return A(e.prev,e,e.next)<0?A(e,t,e.next)>=0&&A(e,e.prev,t)>=0:A(e,t,e.prev)<0||A(e,e.next,t)<0}function Z(e,t){var n=new T(e.i,e.x,e.y),r=new T(t.i,t.x,t.y),i=e.next,s=t.prev;return e.next=t,t.prev=e,n.next=i,i.prev=n,r.next=n,n.prev=r,s.next=r,r.prev=s,r}function S(e,t,n,r){var i=new T(e,t,n);return r?(i.next=r.next,i.prev=r,r.next.prev=i,r.next=i):(i.prev=i,i.next=i),i}function N(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function T(e,t,n){this.i=e,this.x=t,this.y=n,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function R(e,t,n,r){for(var i=0,s=t,o=n-r;s<n;s+=r)i+=(e[o]-e[s])*(e[s+1]+e[o+1]),o=s;return i}n.d(t,{e:()=>r}),r.deviation=function(e,t,n,r){var i=t&&t.length,s=i?t[0]*n:e.length,o=Math.abs(R(e,0,s,n));if(i)for(var l=0,a=t.length;l<a;l++){var u=t[l]*n,c=l<a-1?t[l+1]*n:e.length;o-=Math.abs(R(e,u,c,n))}var h=0;for(l=0;l<r.length;l+=3){var f=r[l]*n,d=r[l+1]*n,p=r[l+2]*n;h+=Math.abs((e[f]-e[p])*(e[d+1]-e[f+1])-(e[f]-e[d])*(e[p+1]-e[f+1]))}return 0===o&&0===h?0:Math.abs((h-o)/o)},r.flatten=function(e){for(var t=e[0][0].length,n={vertices:[],holes:[],dimensions:t},r=0,i=0;i<e.length;i++){for(var s=0;s<e[i].length;s++)for(var o=0;o<t;o++)n.vertices.push(e[i][s][o]);i>0&&(r+=e[i-1].length,n.holes.push(r))}return n}},77176:(e,t,n)=>{n.d(t,{b:()=>s});var r=n(15941),i=n(38496);function s(e,t,n){const s=Array.isArray(e),c=s?e.length/t:e.byteLength/(4*t),h=s?e:new Uint32Array(e,0,c*t),f=n?.minReduction??0,d=n?.originalIndices||null,p=d?d.length:0,x=n?.componentOffsets||null;let v=0;if(x)for(let r=0;r<x.length-1;r++){const e=x[r+1]-x[r];e>v&&(v=e)}else v=c;const y=Math.floor(1.1*v)+1;(null==u||u.length<2*y)&&(u=new Uint32Array((0,r.cU)(2*y)));for(let r=0;r<2*y;r++)u[r]=0;let g=0;const _=!!x&&!!d,w=_?p:c;let A=(0,i.my)(c);const m=new Uint32Array(p),b=1.96;let E=0!==f?Math.ceil(4*b*b/(f*f)*f*(1-f)):w,M=1,C=x?x[1]:w;for(let r=0;r<w;r++){if(r===E){const e=1-g/r;if(e+b*Math.sqrt(e*(1-e)/r)<f)return null;E*=2}if(r===C){for(let e=0;e<2*y;e++)u[e]=0;if(d)for(let e=x[M-1];e<x[M];e++)m[e]=A[d[e]];C=x[++M]}const e=_?d[r]:r,n=e*t,i=a(h,n,t);let s=i%y,l=g;for(;0!==u[2*s+1];){if(u[2*s]===i){const e=u[2*s+1]-1;if(o(h,n,e*t,t)){l=A[e];break}}s++,s>=y&&(s-=y)}l===g&&(u[2*s]=i,u[2*s+1]=e+1,g++),A[e]=l}if(0!==f&&1-g/c<f)return null;if(_){for(let e=x[M-1];e<m.length;e++)m[e]=A[d[e]];A=(0,i.Dg)(m)}const Z=s?new Array(g):new Uint32Array(g*t);g=0;for(let r=0;r<w;r++)A[r]===g&&(l(h,(_?d[r]:r)*t,Z,g*t,t),g++);if(d&&!_){const e=new Uint32Array(p);for(let t=0;t<e.length;t++)e[t]=A[d[t]];A=(0,i.Dg)(e)}return{buffer:Array.isArray(Z)?Z:Z.buffer,indices:A,uniqueCount:g}}function o(e,t,n,r){for(let i=0;i<r;i++)if(e[t+i]!==e[n+i])return!1;return!0}function l(e,t,n,r,i){for(let s=0;s<i;s++)n[r+s]=e[t+s]}function a(e,t,n){let r=0;for(let i=0;i<n;i++)r=e[t+i]+r|0,r=r+(r<<11)+(r>>>2)|0;return r>>>0}let u=null},10294:(e,t,n)=>{n.d(t,{S:()=>a});var r=n(15941),i=n(31633),s=n(20664),o=n(5568),l=n(13927);function a(e,t,n){const a=function(e,t,n,r){const o=(e=>!Array.isArray(e[0]))(t)?(e,n)=>t[3*e+n]:(e,n)=>t[e][n],a=r?(0,i.GA)(r)/(0,i.G9)(r):1;return(0,l.lU)(e,((e,t)=>(0,s.i)(e,o(t,0)*a,o(t,1)*a,o(t,2))),n)}(u,e,t,n)?(0,l.Qj)(u):[0,0,1];return Math.abs(a[2])>Math.cos((0,r.kU)(80))?o._.Z:Math.abs(a[1])>Math.abs(a[0])?o._.Y:o._.X}const u=(0,l.vt)()},99785:(e,t,n)=>{n.d(t,{Wq:()=>r,lO:()=>f,oR:()=>d});var r,i,s=n(38983),o=n(5568),l=n(5262),a=n(44815),u=n(38496),c=n(10294),h=n(77176);function f(e){const t=d(e.rings,e.hasZ,r.CCW_IS_HOLE,e.spatialReference),n=new Array;let i=0,o=0;for(const r of t.polygons){const e=r.count,l=r.index,c=(0,a.l5)(t.position,3*l,3*e),h=r.holeIndices.map((e=>e-l)),f=(0,u.Dg)((0,s.e)(c,h,3));n.push({position:c,faces:f}),i+=c.length,o+=f.length}const l=function(e,t,n){if(1===e.length)return e[0];const r=(0,a.jh)(t),i=new Array(n);let s=0,o=0,l=0;for(const a of e){for(let e=0;e<a.position.length;e++)r[s++]=a.position[e];for(const e of a.faces)i[o++]=e+l;l=s/3}return{position:r,faces:(0,u.Dg)(i)}}(n,i,o),c=Array.isArray(l.position)?(0,h.b)(l.position,3,{originalIndices:l.faces}):(0,h.b)(l.position.buffer,6,{originalIndices:l.faces});return l.position=(0,a.xm)(new Float64Array(c.buffer)),l.faces=c.indices,l}function d(e,t,n,i){const s=e.length,o=new Array(s),l=new Array(s),u=new Array(s);let c=0;for(let r=0;r<s;++r)c+=e[r].length;let h=0,f=0,d=0;const v=(0,a.jh)(3*c);let y=0;for(let a=s-1;a>=0;a--){const c=e[a],g=n===r.CCW_IS_HOLE&&x(c,t,i);if(g&&1!==s)o[h++]=c;else{let e=c.length;for(let t=0;t<h;++t)e+=o[t].length;const n={index:y,pathLengths:new Array(h+1),count:e,holeIndices:new Array(h)};n.pathLengths[0]=c.length,c.length>0&&(u[d++]={index:y,count:c.length}),y=g?p(c,c.length-1,-1,v,y,c.length,t):p(c,0,1,v,y,c.length,t);for(let r=0;r<h;++r){const e=o[r];n.holeIndices[r]=y,n.pathLengths[r+1]=e.length,e.length>0&&(u[d++]={index:y,count:e.length}),y=p(e,0,1,v,y,e.length,t)}h=0,n.count>0&&(l[f++]=n)}}for(let r=0;r<h;++r){const e=o[r];e.length>0&&(u[d++]={index:y,count:e.length}),y=p(e,0,1,v,y,e.length,t)}return l.length=f,u.length=d,{position:v,polygons:l,outlines:u}}function p(e,t,n,r,i,s,o){i*=3;for(let l=0;l<s;++l){const s=e[t];r[i++]=s[0],r[i++]=s[1],r[i++]=o&&s[2]?s[2]:0,t+=n}return i/3}function x(e,t,n){if(!t)return!(0,l.$3)(e);const r=e.length-1;switch((0,c.S)(e,r,n)){case o._.X:return!(0,l.$3)(e,o._.Y,o._.Z);case o._.Y:return!(0,l.$3)(e,o._.X,o._.Z);case o._.Z:return!(0,l.$3)(e,o._.X,o._.Y)}}(i=r||(r={}))[i.NONE=0]="NONE",i[i.CCW_IS_HOLE=1]="CCW_IS_HOLE"},66185:(e,t,n)=>{n.r(t),n.d(t,{default:()=>V});var r=n(35143),i=n(30726),s=n(68134),o=n(46053),l=n(85842),a=n(38983),u=n(13191),c=n(20664),h=n(9392),f=n(5809),d=n(44815),p=n(38496),x=n(45136),v=n(64465),y=n(83491),g=n(49296),_=n(16266),w=n(36423),A=n(87925),m=(n(81806),n(76460),n(47249),n(16455)),b=n(36451),E=n(16506),M=n(59246),C=n(80069),Z=n(57162);class S extends M.w{constructor(e,t,r){super(e,t,new E.$(C.a,(()=>n.e(5915).then(n.bind(n,75915)))),r)}initializePipeline(){return(0,Z.Ey)({colorWrite:Z.kn})}}var N=n(40366),T=n(93345);class R extends M.w{constructor(e,t,r){super(e,t,new E.$(N.a,(()=>n.e(7144).then(n.bind(n,47144)))),r)}initializePipeline(){return(0,Z.Ey)({colorWrite:Z.kn,depthTest:{func:T.MT.LEQUAL}})}}var I=n(32119),P=n(11850),O=n(69008),H=n(76718);let F=class extends b.A{constructor(e){super(e),this.consumes={required:["final-color"]},this.produces="final-color",this.focusAreaGeometries=new Array,this._vaos=Array(),this._count=new Array,this._origins=new Array,this._colorParameters=new C.F,this._maskParameters=new N.F,e.techniques.precompile(R),e.techniques.precompile(S)}initialize(){this.setExtrudedVolume()}destroy(){this._vaos.forEach((e=>e.dispose())),this._vaos=[],this._count=[],this._origins=[]}render(e){const t=this.techniques.acquire(R),n=this.techniques.acquire(S),r=this.bindParameters,i=e.find((e=>{let{name:t}=e;return"final-color"===t})),s=i?.getTexture(),o=r.camera,l=o.fullViewport[2],a=o.fullViewport[3],u=this.fboCache.acquire(l,a,"focusArea",m.N.RGBA),c=this.fboCache.acquire(l,a,this.produces);if(!t.compiled||!n.compiled||!this._vaos||this.effect===k.NONE)return this.requestRender(),t.release(),n.release(),c.release(),u.release(),i;const h=this.renderingContext;u.attachDepth(i.getAttachment(this.gl.DEPTH_STENCIL_ATTACHMENT)),h.bindFramebuffer(u.fbo),h.clear(T.NV.COLOR|T.NV.STENCIL),h.setViewport(0,0,l,a),h.gl.clearStencil(0),h.gl.clear(h.gl.STENCIL_BUFFER_BIT),h.setClearStencil(0);for(let f=0;f<this._vaos.length;f++){const e=this._vaos[f],n=this._count[f];e&&(this._maskParameters.origin=this._origins[f],h.bindTechnique(t,r,this._maskParameters),h.setFaceCullingEnabled(!1),h.setStencilTestEnabled(!0),h.setStencilWriteMask(255),h.setStencilFunction(T.MT.ALWAYS,0,255),h.setStencilOpSeparate(T.Y7.FRONT,T.eA.KEEP,T.eA.INCR_WRAP,T.eA.KEEP),h.setStencilOpSeparate(T.Y7.BACK,T.eA.KEEP,T.eA.DECR_WRAP,T.eA.KEEP),h.setDepthWriteEnabled(!1),h.setColorMask(!1,!1,!1,!1),h.bindVAO(e),h.drawArrays(T.WR.TRIANGLES,0,n),h.setFaceCullingEnabled(!1),h.setDepthTestEnabled(!1),h.setStencilFunction(T.MT.NOTEQUAL,0,255),h.setStencilWriteMask(0),h.setColorMask(!0,!0,!0,!0),h.drawArrays(T.WR.TRIANGLES,0,n))}return t.release(),h.gl.clear(h.gl.STENCIL_BUFFER_BIT),h.bindFramebuffer(c.fbo),this._colorParameters.color=s,this._colorParameters.focusArea=u.getTexture(),this._colorParameters.effect=this.effect,h.bindTechnique(n,r,this._colorParameters),h.screen.draw(),u.release(),n.release(),c.attachDepth(i.getAttachment(this.gl.DEPTH_STENCIL_ATTACHMENT)),c}setExtrudedVolume(){const e=this.focusAreaGeometries;this._vaos=[],this._count=[],this._origins=[];for(let t=0;t<e.length;t++){const n=e[t],r=new Array,i=n.indicesBottom;this._origins.push(n.origin);for(let e=0;e<i.length;e++)r.push(n.positions[3*(i[e]-1)]),r.push(n.positions[3*(i[e]-1)+1]),r.push(n.positions[3*(i[e]-1)+2]);const s=n.indicesExtruded;for(let e=0;e<s.length;e++)r.push(n.positions[3*s[e]]),r.push(n.positions[3*s[e]+1]),r.push(n.positions[3*s[e]+2]);const o=new Float32Array(r),l=new O.Z(this.renderingContext,I.D,new Map([["geometry",P.SL]]),new Map([["geometry",H.g.createVertex(this.renderingContext,T._U.STATIC_DRAW,o)]]));this._vaos?.push(l),this._count.push(i.length+s.length)}}};(0,r._)([(0,o.MZ)()],F.prototype,"consumes",void 0),(0,r._)([(0,o.MZ)()],F.prototype,"produces",void 0),(0,r._)([(0,o.MZ)({constructOnly:!0})],F.prototype,"techniques",void 0),(0,r._)([(0,o.MZ)()],F.prototype,"focusAreaGeometries",void 0),(0,r._)([(0,o.MZ)()],F.prototype,"effect",void 0),F=(0,r._)([(0,l.$)("esri.views.3d.webgl-engine.effects.focusArea.FocusAreaRenderNode")],F);class L{constructor(e,t,n,r,i){this.positions=e,this.indicesBottom=t,this.indicesExtruded=n,this.height=r,this.origin=i}}var k,D;(D=k||(k={}))[D.NONE=0]="NONE",D[D.BRIGHT=1]="BRIGHT",D[D.DARK=2]="DARK";const q={none:k.NONE,bright:k.BRIGHT,dark:k.DARK};var U=n(91196);let W=class extends((0,y.w)(U.A)){constructor(){super(...arguments),this.type="focusArea-3d",this._elevationContext=new g.F,this._geometries=new Array}initialize(){this.addHandles([(0,s.wB)((()=>this.layer.geometries),((e,t)=>{t=e,this._extrudePolygons(t),this._setFocusAreaRenderNode()}),s.pc),(0,s.wB)((()=>this.layer.tmpEffect),((e,t)=>{t=e,this._renderNode&&t&&(this._renderNode.effect=q[t])}),s.pc),(0,s.wB)((()=>this.layer.visible),((e,t)=>{e?this._renderNode??=new F({view:this.view,techniques:this.view._stage.renderView.techniques,focusAreaGeometries:this._geometries,effect:q[this.layer.tmpEffect??"none"]}):this._renderNode=(0,i.pR)(this._renderNode)}),s.pc)])}destroy(){this._renderNode=(0,i.pR)(this._renderNode),this._geometries=[]}_extrudePolygons(e){this._geometries=[];for(const t of e){const e=(0,u.vt)(),n=(0,h.vt)(),r=this.view.renderCoordsHelper.viewingMode===v.RT.Global;r||this.view.renderCoordsHelper.worldUpAtPosition(null,n);const i=(0,w.W$)(t);if(null==i)return;(0,f.l)(t.spatialReference,[i.x,i.y,0],e,this.view.renderCoordsHelper.spatialReference);const s=(0,c.n)(z,[e[12]-0*n[0],e[13]-0*n[1],e[14]-0*n[2]]),o=(0,u.vt)();o[12]=-e[12],o[13]=-e[13],o[14]=-e[14];const l=(0,A.C8)(t,this.view.elevationProvider,this.view.renderCoordsHelper,this._elevationContext),{polygons:y,mapPositions:g,position:m}=l;for(const t of y){const i=t.count,l=(0,a.e)(t.mapPositions,t.holeIndices,3);if(0===l.length)continue;const u=l.length,c=6*i,h=(0,p.my)(c+u),f=(0,p.my)(u),v=(0,d.jh)(3*c),y=(0,d.jh)(3*c),w=(0,d.jh)(3*c),A=(0,d.jh)(c);(0,_.K)(m,g,l,t,v,w,y,A,h,f,1e4,n,r),(0,x.t)(v,v,o);const b=new L(v,f,h,1e4,[e[12]+0*s[0],e[13]+0*s[1],e[14]+0*s[2]]);this._geometries.push(b)}}}_setFocusAreaRenderNode(){this._renderNode?(this._renderNode.focusAreaGeometries=this._geometries,this._renderNode.setExtrudedVolume()):this._renderNode=new F({view:this.view,techniques:this.view._stage.renderView.techniques,focusAreaGeometries:this._geometries,effect:q[this.layer.tmpEffect??"none"]})}};(0,r._)([(0,o.MZ)()],W.prototype,"type",void 0),(0,r._)([(0,o.MZ)()],W.prototype,"layer",void 0),W=(0,r._)([(0,l.$)("esri.views.3d.layers.FocusAreaLayerView3D")],W);const z=(0,h.vt)(),V=W},83491:(e,t,n)=>{n.d(t,{w:()=>c});var r=n(35143),i=n(54901),s=n(50346),o=n(68134),l=n(46053),a=(n(81806),n(76460),n(47249),n(85842)),u=n(47700);const c=e=>{let t=class extends e{constructor(){super(...arguments),this.slicePlaneEnabled=!1,this.supportsHeightUnitConversion=!1}postscript(){super.postscript(),(0,u.jI)(this.layer)&&this.addResolvingPromise(this._validateHeightModelInfo())}async _validateHeightModelInfo(){const e=new AbortController,t=e.signal;this.addHandles((0,i.hA)((()=>e.abort()))),await(0,o.C_)((()=>this.view.defaultsFromMap?.heightModelInfoReady),t),(0,s.Te)(t);const n=(0,u.Hu)(this.layer,this.view.heightModelInfo,this.supportsHeightUnitConversion);if(n)throw n}};return(0,r._)([(0,l.MZ)()],t.prototype,"view",void 0),(0,r._)([(0,l.MZ)()],t.prototype,"slicePlaneEnabled",void 0),t=(0,r._)([(0,a.$)("esri.views.3d.layers.LayerView3D")],t),t}},91196:(e,t,n)=>{n.d(t,{A:()=>x});var r=n(35143),i=n(91967),s=n(54099),o=n(5632),l=n(76460),a=n(30726),u=n(91291),c=n(46053),h=(n(81806),n(47249),n(85842)),f=n(19451),d=n(90992);let p=class extends((0,o.sA)((0,u.g)(s.A.EventedMixin(i.A)))){constructor(e){super(e),this._updatingHandles=new f.U,this.layer=null,this.parent=null}initialize(){this.when().catch((e=>{if("layerview:create-error"!==e.name){const t=this.layer&&this.layer.id||"no id",n=this.layer?.title||"no title";l.A.getLogger(this).error("#resolve()",`Failed to resolve layer view (layer title: '${n}', id: '${t}')`,e)}}))}destroy(){this._updatingHandles=(0,a.pR)(this._updatingHandles)}get fullOpacity(){return(this.layer?.opacity??1)*(this.parent?.fullOpacity??1)}get suspended(){return this.destroyed||!this.canResume()}get suspendInfo(){return this.getSuspendInfo()}get legendEnabled(){return!this.suspended&&!0===this.layer?.legendEnabled}get updating(){return!(!this._updatingHandles?.updating&&!this.isUpdating())}get updatingProgress(){return this.updating?0:1}get updateSuspended(){return this.suspended}get visible(){return!0===this.layer?.visible}set visible(e){this._overrideIfSome("visible",e)}get visibleAtCurrentScale(){return!0}get visibleAtCurrentTimeExtent(){const e=this.view.timeExtent,t=this.layer?.visibilityTimeExtent;return!e||!t||!e.intersection(t).isEmpty}canResume(){const e=this.layer&&"effectiveScaleRange"in this.layer?this.layer.effectiveScaleRange:null;return this.visible&&this.layer?.loaded&&!this.parent?.suspended&&this.view?.ready&&(0,d.g7)(e)&&this.visibleAtCurrentScale&&this.visibleAtCurrentTimeExtent||!1}getSuspendInfo(){const e=this.parent?.suspended?this.parent.suspendInfo:{};this.view?.ready||(e.viewNotReady=!0),this.layer&&this.layer.loaded||(e.layerNotLoaded=!0);const t=this.layer&&"effectiveScaleRange"in this.layer?this.layer.effectiveScaleRange:null;return(0,d.g7)(t)&&this.visibleAtCurrentScale||(e.outsideScaleRange=!0),this.visibleAtCurrentTimeExtent||(e.outsideVisibilityTimeExtent=!0),this.visible||(e.layerInvisible=!0),e}isUpdating(){return!1}};(0,r._)([(0,c.MZ)()],p.prototype,"view",void 0),(0,r._)([(0,c.MZ)()],p.prototype,"fullOpacity",null),(0,r._)([(0,c.MZ)()],p.prototype,"layer",void 0),(0,r._)([(0,c.MZ)()],p.prototype,"parent",void 0),(0,r._)([(0,c.MZ)({readOnly:!0})],p.prototype,"suspended",null),(0,r._)([(0,c.MZ)({readOnly:!0})],p.prototype,"suspendInfo",null),(0,r._)([(0,c.MZ)({readOnly:!0})],p.prototype,"legendEnabled",null),(0,r._)([(0,c.MZ)({type:Boolean,readOnly:!0})],p.prototype,"updating",null),(0,r._)([(0,c.MZ)({readOnly:!0})],p.prototype,"updatingProgress",null),(0,r._)([(0,c.MZ)()],p.prototype,"updateSuspended",null),(0,r._)([(0,c.MZ)()],p.prototype,"visible",null),(0,r._)([(0,c.MZ)({readOnly:!0})],p.prototype,"visibleAtCurrentScale",null),(0,r._)([(0,c.MZ)({readOnly:!0})],p.prototype,"visibleAtCurrentTimeExtent",null),p=(0,r._)([(0,h.$)("esri.views.layers.LayerView")],p);const x=p}}]);
//# sourceMappingURL=7371.9ce95206.chunk.js.map